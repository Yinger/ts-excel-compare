(this["webpackJsonpts-excel-compare"]=this["webpackJsonpts-excel-compare"]||[]).push([[0],{1340:function(e,t){},1341:function(e,t){},1366:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1366},1434:function(e,t,n){},1436:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(100),l=n.n(r),o=(n(642),n(132)),s=n(1438),c=n(1440),u=n(1441),f=n(300),h=n(312),m=n.n(h),d=function e(){Object(f.a)(this,e),this.getSheet=function(e,t,n){return new Promise((function(a,i){var r=e.Sheets[t],l={items:m.a.utils.sheet_to_json(r,{header:1})};return a(l),n(null,l)}))},this.convertFileToExcel=function(e,t){return new Promise((function(n,a){var i=new FileReader,r=!!i.readAsBinaryString;i.onload=function(e){var a,i=null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.result,l=m.a.read(i,{type:r?"binary":"array"}),o=l.SheetNames[0],s=l.Sheets[o],c={items:m.a.utils.sheet_to_json(s,{header:1}),sheets:l.SheetNames,workbook:l};return n(c),t(null,c)},e&&r?i.readAsBinaryString(e):i.readAsArrayBuffer(e)}))}};d.SheetJSFT=function(){return["xlsx"].map((function(e){return"."+e})).join(",")},d.BlankData=function(e,t){return new Array(e).fill("").map((function(){return new Array(t).fill("")}))},d.SampleDataLeft=function(){return[["Date","High","Low","Close","Volume","ask","cash"],["2019-07-08 00:00:00","11540.33","11469.53","11506.43","10.77073088","0","100000000"],["2019-07-07 19:00:00","11610.0","11432.32","11547.98","67.915214697","0","100000000"],["2019-07-07 18:00:00","11525.0","11426.74","11470.47","31.1094771869","0","100000000"],["2019-07-07 16:00:00","11254.97","11135.01","11201.6","23.5194946648","0","100000000"],["2019-07-07 15:00:00","11408.02","11189.0","11254.97","64.0821938629","0","100000000"]]},d.SampleDataRight=function(){return[["Date","High","Low","Close","Volume","bid","ask","Buy"],["2019-07-07 23:00:00","11482.72","11423.0","11475.07","32.99655899","6","0","3"],["2019-07-07 19:00:00","11610.0","11432.32","11547.98","67.915214697","6","0","9"],["2019-07-07 18:10:00","11525.0","11426.74","11470.47","31.1094771869","6","0","9"],["2019-07-07 17:20:00","11566.23","11211.56","11503.4","121.5246740453","0","9"],["2019-07-07 16:00:00","11254.97","11135.01","11200.6","23.5194946648","6","0","9"],["2019-07-07 15:00:00","11408.02","11189.0","11254.97","64.0821938629","6","1","9"]]};var p=n(410),g=n(213),b=n(1439),S=(n(614),function(e){return i.a.createElement(b.a.Group,{compact:!0,style:{marginRight:10,marginTop:-25,marginBottom:3}},i.a.createElement("input",{name:"file-upload",style:{width:"50%",marginTop:10},type:"file",accept:d.SheetJSFT(),"aria-label":"Select original file",onChange:function(t){return e.onFileSelectChange(t)},ref:e.fileRef}),i.a.createElement(s.a,{style:{width:"40%"},value:e.sheetname,onChange:function(t){return e.onSheetSelectChange(t)}},e.sheetlist))});S.defaultProps={sheetname:"Sheet1",sheetlist:null};var v=S,y=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"left",style:{padding:10,marginTop:-25}},i.a.createElement("h1",{style:{marginLeft:3}},"<\u5143\u30fboriginal>"),i.a.createElement(v,{sheetname:e.sheetname,sheetlist:e.sheetlist,onFileSelectChange:function(t){return e.onFileSelectChange(t)},onSheetSelectChange:function(t){return e.onSheetSelectChange(t)},fileRef:e.fileRef}),i.a.createElement(g.a,{ref:e.hotTableComponentLeft,data:e.sheetdata,style:{width:"98%"},settings:{colHeaders:!0,rowHeaders:!0,height:305,minRows:12,minCols:8,licenseKey:"non-commercial-and-evaluation",id:"table-left"},stretchH:"all"})))},j=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"right",style:{padding:10,marginTop:-25}},i.a.createElement("h1",{style:{marginLeft:3}},"<\u5148\u30fbmodified>"),i.a.createElement(v,{sheetname:e.sheetname,sheetlist:e.sheetlist,onFileSelectChange:function(t){return e.onFileSelectChange(t)},onSheetSelectChange:function(t){return e.onSheetSelectChange(t)},fileRef:e.fileRef}),i.a.createElement(g.a,{ref:e.hotTableComponentRight,data:e.sheetdata,style:{width:"98%"},settings:{colHeaders:!0,rowHeaders:!0,height:305,minRows:12,minCols:8,licenseKey:"non-commercial-and-evaluation",id:"table-right"},stretchH:"all"})))},w=n(406),O=function(e){return i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(w.a,{type:"dashed",size:"small",style:{marginTop:150},onClick:function(t){return e.onSampleBtnClick(t)}},"< Sample >"),i.a.createElement(w.a,{ref:i.a.createRef(),id:"btn-diff",type:"primary",style:{marginTop:10},size:"large",onClick:function(t){return e.onDiffBtnClick(t)}},e.btntext),i.a.createElement(w.a,{ref:i.a.createRef(),id:"btn-clean",type:"default",style:{marginTop:10},onClick:function(t){return e.onResetBtnClick(t)}}," << reset >> "))},C=n(630),E=function(){function e(t,n){Object(f.a)(this,e),this.value=void 0,this.instance=void 0,this.value=t,this.instance=n}return Object(C.a)(e,[{key:"getCell",value:function(e,t){var n=this.instance.getDataAtCell(t,e);return null===n?n:void 0===n?"":""+n}},{key:"getValue",value:function(){return this.value}}]),e}(),k=n(410);function _(e,t,n,a,i,r,l){var o=new E(r,e),s=new k.coopy.SimpleView,c=k.coopy.DiffRender.renderCell(o,s,a,n),u=c.category,f=c.pretty_value;return""!==u&&(t.className=u),t.innerHTML=f,f}var D=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{style:{fontSize:24}},"\u6bd4\u8f03\u7d50\u679c"),i.a.createElement(g.a,{ref:e.hotTableComponentDiffResult,data:[[""]],style:{width:"100%",padding:15},id:"tableresult",settings:{minRows:10,minCols:10,minSpareCols:0,minSpareRows:0,colHeaders:!1,contextMenu:!1,rowHeaders:!1,readOnly:!0,renderAllRows:!0,licenseKey:"non-commercial-and-evaluation"},renderer:_,className:"diffhandsontable",stretchH:"all"}))};n(1433),n(1434),n(1435);var R=function(){var e=new d,t=Object(a.useState)("Sheet1"),n=Object(o.a)(t,2),r=n[0],l=n[1],f=Object(a.useState)(null),h=Object(o.a)(f,2),m=h[0],g=h[1],b=Object(a.useState)(i.a.createRef()),S=Object(o.a)(b,1)[0],v=Object(a.useState)(JSON.parse(JSON.stringify(d.BlankData(12,8)))),w=Object(o.a)(v,2),C=w[0],E=w[1],k=Object(a.useState)(),_=Object(o.a)(k,2),R=_[0],T=_[1],N=Object(a.useState)("Sheet1"),F=Object(o.a)(N,2),x=F[0],B=F[1],L=Object(a.useState)(null),H=Object(o.a)(L,2),J=H[0],A=H[1],U=Object(a.useState)(i.a.createRef()),M=Object(o.a)(U,1)[0],V=Object(a.useState)(JSON.parse(JSON.stringify(d.BlankData(12,8)))),z=Object(o.a)(V,2),K=z[0],P=z[1],I=Object(a.useState)(),W=Object(o.a)(I,2),G=W[0],$=W[1],q=Object(a.useState)(">> Diff <<"),Q=Object(o.a)(q,1)[0],X=Object(a.useState)(i.a.createRef()),Y=Object(o.a)(X,1)[0],Z=Object(a.useRef)(null),ee=Object(a.useRef)(null),te=function(t,n){if(t.persist(),t.target.files){var a=t.target.files[0];a&&e.convertFileToExcel(a,(function(e,t){if(e)console.log(e);else{for(var a=[],r=0;r<t.sheets.length;r++)a.push(i.a.createElement(s.a.Option,{key:t.sheets[r],value:t.sheets[r]},t.sheets[r]));"left"===n?(l(t.sheets[0]),g(a),E(t.items),T(t.workbook)):(B(t.sheets[0]),A(a),P(t.items),$(t.workbook))}}))}},ne=function(t,n){var a=null;void 0!==(a="left"===n?R:G)&&null!==a&&void 0!==t&&e.getSheet(a,t,(function(e,a){e?console.log(e):"left"===n?(l(t),E(a.items)):(B(t),P(a.items))}))};return i.a.createElement("div",{className:"App"},i.a.createElement(c.a,null,i.a.createElement(u.a,{span:11},i.a.createElement(y,{sheetname:r,sheetlist:m,onFileSelectChange:function(e){return te(e,"left")},onSheetSelectChange:function(e){return ne(e,"left")},hotTableComponentLeft:S,sheetdata:C,fileRef:Z})),i.a.createElement(u.a,{span:2},i.a.createElement(O,{btntext:Q,onDiffBtnClick:function(e){!function(e,t,n){var a=n.current.hotInstance,i=[],r=new p.TableView(e),l=new p.TableView(t);r.trim(),l.trim();var o=p.compareTables(r,l).align(),s=new p.TableView([]),c=new p.CompareFlags;c.show_unchanged=!1,c.always_show_header=!0,c.always_show_order=!0,c.never_show_order=!1,c.unchanged_context=!0,new p.TableDiff(o,c).hilite(s),0!==s.height&&(i=s.data,a.loadData(i))}(C,K,Y)},onSampleBtnClick:function(e){E(d.SampleDataLeft),P(d.SampleDataRight)},onResetBtnClick:function(e){Z.current.value="",ee.current.value="",g(null),A(null),l("Sheet1"),B("Sheet1"),E(JSON.parse(JSON.stringify(d.BlankData(12,8)))),P(JSON.parse(JSON.stringify(d.BlankData(12,8))))}})),i.a.createElement(u.a,{span:11},i.a.createElement(j,{sheetname:x,sheetlist:J,onFileSelectChange:function(e){return te(e,"right")},onSheetSelectChange:function(e){return ne(e,"right")},hotTableComponentRight:M,sheetdata:K,fileRef:ee})),i.a.createElement(u.a,{span:24,style:{textAlign:"center"}},i.a.createElement(D,{hotTableComponentDiffResult:Y}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},370:function(e,t){},409:function(e,t){},483:function(e,t,n){var a={"./build":484,"./build.js":484,"./clean":533,"./clean.js":533,"./configure":362,"./configure.js":362,"./info":534,"./info.js":534,"./install":557,"./install.js":557,"./node-pre-gyp":334,"./node-pre-gyp.js":334,"./package":569,"./package.js":569,"./pre-binding":342,"./pre-binding.js":342,"./publish":571,"./publish.js":571,"./rebuild":572,"./rebuild.js":572,"./reinstall":573,"./reinstall.js":573,"./reveal":574,"./reveal.js":574,"./testbinary":379,"./testbinary.js":379,"./testpackage":575,"./testpackage.js":575,"./unpublish":576,"./unpublish.js":576,"./util/abi_crosswalk":343,"./util/abi_crosswalk.json":343,"./util/compile":267,"./util/compile.js":267,"./util/handle_gyp_opts":277,"./util/handle_gyp_opts.js":277,"./util/napi":90,"./util/napi.js":90,"./util/nw-pre-gyp/index.html":1364,"./util/nw-pre-gyp/package":577,"./util/nw-pre-gyp/package.json":577,"./util/s3_setup":232,"./util/s3_setup.js":232,"./util/versioning":121,"./util/versioning.js":121};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=483},485:function(e,t,n){var a={"./Find-VS2017.cs":805,"./build":486,"./build.js":486,"./clean":488,"./clean.js":488,"./configure":489,"./configure.js":489,"./find-node-directory":345,"./find-node-directory.js":345,"./find-vs2017":346,"./find-vs2017.js":346,"./install":490,"./install.js":490,"./list":530,"./list.js":530,"./node-gyp":344,"./node-gyp.js":344,"./process-release":221,"./process-release.js":221,"./rebuild":531,"./rebuild.js":531,"./remove":532,"./remove.js":532};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=485},637:function(e,t,n){e.exports=n(1436)},642:function(e,t,n){},646:function(e,t){},647:function(e,t){},649:function(e,t){},651:function(e,t){},661:function(e,t){},663:function(e,t){},689:function(e,t){},691:function(e,t){},692:function(e,t){},698:function(e,t){},700:function(e,t){},718:function(e,t){},720:function(e,t){},732:function(e,t){},735:function(e,t){},740:function(e,t){},742:function(e,t){},760:function(e,t){},762:function(e,t){},798:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=798},799:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=799},840:function(e,t){}},[[637,1,2]]]);
//# sourceMappingURL=main.f9bdb952.chunk.js.map