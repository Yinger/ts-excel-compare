(this["webpackJsonpts-excel-compare"]=this["webpackJsonpts-excel-compare"]||[]).push([[0],{1342:function(e,t){},1343:function(e,t){},1368:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=1368},1435:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(100),o=n.n(r),l=(n(642),n(132)),s=n(1437),c=n(1439),u=n(1440),f=(n(643),n(644),n(300)),h=n(312),d=n.n(h),m=function e(){Object(f.a)(this,e),this.getSheet=function(e,t,n){return new Promise((function(a,i){var r=e.Sheets[t],o={items:d.a.utils.sheet_to_json(r,{header:1})};return a(o),n(null,o)}))},this.convertFileToExcel=function(e,t){return new Promise((function(n,a){var i=new FileReader,r=!!i.readAsBinaryString;i.onload=function(e){var a,i=null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.result,o=d.a.read(i,{type:r?"binary":"array"}),l=o.SheetNames[0],s=o.Sheets[l],c={items:d.a.utils.sheet_to_json(s,{header:1}),sheets:o.SheetNames,workbook:o};return n(c),t(null,c)},e&&r?i.readAsBinaryString(e):i.readAsArrayBuffer(e)}))}};m.SheetJSFT=function(){return["xlsx"].map((function(e){return"."+e})).join(",")},m.BlankData=function(e,t){return new Array(e).fill("").map((function(){return new Array(t).fill("")}))};var p=n(410),g=n(213),b=n(1438),v=(n(614),function(e){return i.a.createElement(b.a.Group,{compact:!0,style:{marginRight:10,marginTop:-15}},i.a.createElement("input",{name:"file-upload",style:{width:"50%"},type:"file",accept:m.SheetJSFT(),"aria-label":"Select original file",onChange:function(t){return e.onFileSelectChange(t)}}),i.a.createElement(s.a,{style:{width:"40%"},value:e.sheetname,onChange:function(t){return e.onSheetSelectChange(t)}},e.sheetlist))});v.defaultProps={sheetname:"Sheet1",sheetlist:null};var j=v,w=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"left",style:{padding:10}},i.a.createElement("h1",{style:{marginLeft:3}},"<\u5143\u30fboriginal>"),i.a.createElement(j,{sheetname:e.sheetname,sheetlist:e.sheetlist,onFileSelectChange:function(t){return e.onFileSelectChange(t)},onSheetSelectChange:function(t){return e.onSheetSelectChange(t)}}),i.a.createElement(g.a,{ref:e.hotTableComponentLeft,data:e.sheetdata,style:{width:"100%"},settings:{colHeaders:!0,rowHeaders:!0,height:305,minRows:5,minCols:5,colWidth:100,licenseKey:"non-commercial-and-evaluation",id:"table-left"},stretchH:"all"})))},y=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"right",style:{padding:10}},i.a.createElement("h1",{style:{marginLeft:3}},"<\u5148\u30fbmodified>"),i.a.createElement(j,{sheetname:e.sheetname,sheetlist:e.sheetlist,onFileSelectChange:function(t){return e.onFileSelectChange(t)},onSheetSelectChange:function(t){return e.onSheetSelectChange(t)}}),i.a.createElement(g.a,{ref:e.hotTableComponentRight,data:e.sheetdata,style:{width:"100%"},settings:{colHeaders:!0,rowHeaders:!0,height:305,minRows:5,minCols:5,colWidth:100,licenseKey:"non-commercial-and-evaluation",id:"table-right"},stretchH:"all"})))},S=n(406),O=function(e){return i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement(S.a,{ref:i.a.createRef(),id:"btn-diff",type:"primary",style:{marginTop:150},onClick:function(t){return e.onDiffBtnClick(t)}},e.btntext))},E=n(630),C=function(){function e(t,n){Object(f.a)(this,e),this.value=void 0,this.instance=void 0,this.value=t,this.instance=n}return Object(E.a)(e,[{key:"getCell",value:function(e,t){var n=this.instance.getDataAtCell(t,e);return null===n?n:void 0===n?"":""+n}},{key:"getValue",value:function(){return this.value}}]),e}(),k=n(410);function _(e,t,n,a,i,r,o){var l=new C(r,e),s=new k.coopy.SimpleView,c=k.coopy.DiffRender.renderCell(l,s,a,n),u=c.category,f=c.pretty_value;return""!==u&&(t.className=u),t.innerHTML=f,f}var D=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{style:{fontSize:24}},"\u6bd4\u8f03\u7d50\u679c"),i.a.createElement(g.a,{ref:e.hotTableComponentDiffResult,data:[[""]],style:{width:"100%",padding:15},id:"tableresult",settings:{minRows:10,minCols:10,minSpareCols:0,minSpareRows:0,colHeaders:!1,contextMenu:!1,rowHeaders:!1,readOnly:!0,renderAllRows:!0,licenseKey:"non-commercial-and-evaluation"},renderer:_,className:"diffhandsontable",stretchH:"all"}))};var T=function(){var e=new m,t=Object(a.useState)("Sheet1"),n=Object(l.a)(t,2),r=n[0],o=n[1],f=Object(a.useState)(null),h=Object(l.a)(f,2),d=h[0],g=h[1],b=Object(a.useState)(i.a.createRef()),v=Object(l.a)(b,1)[0],j=Object(a.useState)(JSON.parse(JSON.stringify(m.BlankData(12,10)))),S=Object(l.a)(j,2),E=S[0],C=S[1],k=Object(a.useState)(),_=Object(l.a)(k,2),T=_[0],F=_[1],N=Object(a.useState)("Sheet1"),x=Object(l.a)(N,2),R=x[0],A=x[1],B=Object(a.useState)(null),H=Object(l.a)(B,2),L=H[0],U=H[1],J=Object(a.useState)(i.a.createRef()),M=Object(l.a)(J,1)[0],V=Object(a.useState)(JSON.parse(JSON.stringify(m.BlankData(12,10)))),W=Object(l.a)(V,2),K=W[0],P=W[1],I=Object(a.useState)(),z=Object(l.a)(I,2),G=z[0],$=z[1],q=Object(a.useState)(">> Diff <<"),Q=Object(l.a)(q,1)[0],X=Object(a.useState)(i.a.createRef()),Y=Object(l.a)(X,1)[0],Z=function(t,n){if(t.persist(),t.target.files){var a=t.target.files[0];a&&e.convertFileToExcel(a,(function(e,t){if(e)console.log(e);else{for(var a=[],r=0;r<t.sheets.length;r++)a.push(i.a.createElement(s.a.Option,{key:t.sheets[r],value:t.sheets[r]},t.sheets[r]));"left"===n?(o(t.sheets[0]),g(a),C(t.items),F(t.workbook)):(A(t.sheets[0]),U(a),P(t.items),$(t.workbook))}}))}},ee=function(t,n){var a=null;void 0!==(a="left"===n?T:G)&&null!==a&&void 0!==t&&e.getSheet(a,t,(function(e,a){e?console.log(e):"left"===n?(o(t),C(a.items)):(A(t),P(a.items))}))},te=function(e){e.preventDefault(),function(e,t,n){var a=n.current.hotInstance,i=[],r=new p.TableView(e),o=new p.TableView(t);r.trim(),o.trim();var l=p.compareTables(r,o).align(),s=new p.TableView([]),c=new p.CompareFlags;c.show_unchanged=!1,c.always_show_header=!0,c.always_show_order=!0,c.never_show_order=!1,c.unchanged_context=!0,new p.TableDiff(l,c).hilite(s),0!==s.height&&(i=s.data,a.loadData(i))}(E,K,Y)};return i.a.createElement("div",{className:"App"},i.a.createElement(c.a,null,i.a.createElement(u.a,{span:11},i.a.createElement(w,{sheetname:r,sheetlist:d,onFileSelectChange:function(e){return Z(e,"left")},onSheetSelectChange:function(e){return ee(e,"left")},hotTableComponentLeft:v,sheetdata:E})),i.a.createElement(u.a,{span:2},i.a.createElement(O,{btntext:Q,onDiffBtnClick:function(e){te(e)}})),i.a.createElement(u.a,{span:11},i.a.createElement(y,{sheetname:R,sheetlist:L,onFileSelectChange:function(e){return Z(e,"right")},onSheetSelectChange:function(e){return ee(e,"right")},hotTableComponentRight:M,sheetdata:K})),i.a.createElement(u.a,{span:24,style:{textAlign:"center"}},i.a.createElement(D,{hotTableComponentDiffResult:Y}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},370:function(e,t){},409:function(e,t){},483:function(e,t,n){var a={"./build":484,"./build.js":484,"./clean":533,"./clean.js":533,"./configure":362,"./configure.js":362,"./info":534,"./info.js":534,"./install":557,"./install.js":557,"./node-pre-gyp":334,"./node-pre-gyp.js":334,"./package":569,"./package.js":569,"./pre-binding":342,"./pre-binding.js":342,"./publish":571,"./publish.js":571,"./rebuild":572,"./rebuild.js":572,"./reinstall":573,"./reinstall.js":573,"./reveal":574,"./reveal.js":574,"./testbinary":379,"./testbinary.js":379,"./testpackage":575,"./testpackage.js":575,"./unpublish":576,"./unpublish.js":576,"./util/abi_crosswalk":343,"./util/abi_crosswalk.json":343,"./util/compile":267,"./util/compile.js":267,"./util/handle_gyp_opts":277,"./util/handle_gyp_opts.js":277,"./util/napi":90,"./util/napi.js":90,"./util/nw-pre-gyp/index.html":1366,"./util/nw-pre-gyp/package":577,"./util/nw-pre-gyp/package.json":577,"./util/s3_setup":232,"./util/s3_setup.js":232,"./util/versioning":121,"./util/versioning.js":121};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=483},485:function(e,t,n){var a={"./Find-VS2017.cs":807,"./build":486,"./build.js":486,"./clean":488,"./clean.js":488,"./configure":489,"./configure.js":489,"./find-node-directory":345,"./find-node-directory.js":345,"./find-vs2017":346,"./find-vs2017.js":346,"./install":490,"./install.js":490,"./list":530,"./list.js":530,"./node-gyp":344,"./node-gyp.js":344,"./process-release":221,"./process-release.js":221,"./rebuild":531,"./rebuild.js":531,"./remove":532,"./remove.js":532};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=485},637:function(e,t,n){e.exports=n(1435)},642:function(e,t,n){},644:function(e,t,n){},648:function(e,t){},649:function(e,t){},651:function(e,t){},653:function(e,t){},663:function(e,t){},665:function(e,t){},691:function(e,t){},693:function(e,t){},694:function(e,t){},700:function(e,t){},702:function(e,t){},720:function(e,t){},722:function(e,t){},734:function(e,t){},737:function(e,t){},742:function(e,t){},744:function(e,t){},762:function(e,t){},764:function(e,t){},800:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=800},801:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=801},842:function(e,t){}},[[637,1,2]]]);
//# sourceMappingURL=main.9ae0d7e2.chunk.js.map